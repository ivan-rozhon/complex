<div flex="100">
    <md-button ng-if="$ctrl.index !== 0" class="md-icon-button" aria-label="Up" ng-click="$ctrl.doMoveItem(true)">
        <md-icon md-font-icon="material-icons">arrow_drop_up</md-icon>
        <md-tooltip>Up</md-tooltip>
    </md-button>
    <md-button ng-if="!$ctrl.lastIndex" class="md-icon-button" aria-label="Down" ng-click="$ctrl.doMoveItem(false)">
        <md-icon md-font-icon="material-icons">arrow_drop_down</md-icon>
        <md-tooltip>Down</md-tooltip>
    </md-button>
    <md-button class="md-icon-button" aria-label="Delete" ng-click="$ctrl.doDeleteItem()">
        <md-icon md-font-icon="material-icons">delete</md-icon>
        <md-tooltip>Delete</md-tooltip>
    </md-button>
</div>

<div ng-repeat="(key, value) in $ctrl.data" ng-switch="$ctrl.config[key].type" ng-class="$ctrl.config[key].type"
    flex="{{
        $ctrl.config[key].type === 'textarea' ||
        $ctrl.config[key].type === 'chips' ||
        $ctrl.config[key].type === 'array' ||
        $ctrl.config[key].long ? 100 : 'none' }}">

    <h4 ng-if="$ctrl.config[key].type === 'array'">{{ $ctrl.config[key].label }}</h4>
    <npc-data-input layout="row" layout-wrap ng-switch-when="array" ng-repeat="(subKey, subValue) in value"
        index="$index"
        last-index="$last"
        key="key"
        data="subValue"
        config="$ctrl.config"
        add-item="$ctrl.addDataItem(key, index)"
        delete-item="$ctrl.deleteDataItem(key, index)"
        move-item="$ctrl.moveDataItem(direction, key, index)"></npc-data-input>

    <div flex="100" ng-if="$ctrl.config[key].type === 'array' && !value.length">
        <md-button class="md-icon-button" aria-label="Add group" ng-click="$ctrl.addGroup(key)">
            <md-icon md-font-icon="material-icons">library_add</md-icon>
            <md-tooltip>Add {{ $ctrl.config[key].label }}</md-tooltip>
        </md-button>
    </div>

    <npc-data-input-model ng-switch-default class="md-block"
        input-data="$ctrl.config[key]"
        input-model="$ctrl.data[key]"></npc-data-input-model>
</div>

<div flex="100">
    <!-- Non-generic 'Add' btn -->
    <md-button ng-if="$ctrl.key !== 'generic'" class="md-icon-button" aria-label="Add" ng-click="$ctrl.doAddItem()">
        <md-icon md-font-icon="material-icons">add_box</md-icon>
        <md-tooltip>Add</md-tooltip>
    </md-button>

    <!-- Generic 'Add' btn -->
    <div flex="100" ng-if="$ctrl.key === 'generic'">
        <md-menu flex="100" ng-if="$ctrl.key === 'generic'">
            <md-button class="md-icon-button" aria-label="Add generic" ng-click="$ctrl.openGenericMenu($mdMenu, $event)">
                <md-icon md-font-icon="material-icons">add_box</md-icon>
            </md-button>
            <md-menu-content width="4">
                <md-menu-item ng-repeat="(subKey, subValue) in $ctrl.config[$ctrl.key].aviable">
                    <md-button ng-click="$ctrl.addGenericItem($ctrl.key, subKey)">
                        {{ $ctrl.config[subKey].label }}
                    </md-button>
                </md-menu-item>
            </md-menu-content>
        </md-menu>
    </div>
</div>